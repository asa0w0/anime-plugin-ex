<div class="anime-card-enhanced">
    <LinkTo @route="anime.show" @model={{@anime.mal_id}} class="anime-card-link">
        <div class="anime-card-image">
            <img src={{@anime.images.jpg.image_url}} alt={{@anime.title}} loading="lazy" />
            <div class="anime-card-rating">
                <span class="score">⭐ {{this.animeScore}}</span>
            </div>
        </div>
        <div class="anime-card-content">
            <h3 class="anime-card-title">{{@anime.title}}</h3>

            {{#if this.typeLabel}}
            <div class="anime-card-meta">
                <span class="meta-type">{{this.typeLabel}}</span>
                {{#if this.episodeCount}}
                <span class="meta-separator">•</span>
                <span class="meta-episodes">{{this.episodeCount}}</span>
                {{/if}}
            </div>
            {{/if}}

            {{#if this.topGenres.length}}
            <div class="anime-card-genres">
                {{#each this.topGenres as |genre|}}
                <span class="genre-tag">{{genre}}</span>
                {{/each}}
            </div>
            {{/if}}
        </div>
    </LinkTo>

    {{#if this.currentUser}}
    <div class="anime-card-quick-add-container {{if this.showStatusMenu " menu-open"}}">
        <button type="button" class="anime-card-quick-add {{if this.isOnWatchlist " on-watchlist"}}" {{on "click"
            this.toggleStatusMenu}} title="Update Watchlist Status">
            {{d-icon (if this.isOnWatchlist "heart" "heart")}}
        </button>

        {{#if this.showStatusMenu}}
        <div class="anime-status-menu">
            <button type="button" class="status-item watching" {{on "click" (fn this.selectStatus "watching" )}}>
                {{d-icon "play-circle"}} Watching
            </button>
            <button type="button" class="status-item completed" {{on "click" (fn this.selectStatus "completed" )}}>
                {{d-icon "check-circle"}} Completed
            </button>
            <button type="button" class="status-item plan_to_watch" {{on "click" (fn this.selectStatus "plan_to_watch"
                )}}>
                {{d-icon "clock"}} Plan to Watch
            </button>
            <button type="button" class="status-item on_hold" {{on "click" (fn this.selectStatus "on_hold" )}}>
                {{d-icon "pause-circle"}} On Hold
            </button>
            <button type="button" class="status-item dropped" {{on "click" (fn this.selectStatus "dropped" )}}>
                {{d-icon "times-circle"}} Dropped
            </button>
            {{#if this.isOnWatchlist}}
            <button type="button" class="status-item remove" {{on "click" (fn this.selectStatus "remove" )}}>
                {{d-icon "trash-alt"}} Remove
            </button>
            {{/if}}
        </div>
        {{/if}}
    </div>
    {{/if}}
</div>